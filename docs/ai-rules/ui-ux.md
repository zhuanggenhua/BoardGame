# UI/UX 完整规范

> 本文档是 `AGENTS.md` 的补充，包含 UI/UX 设计范式、布局策略、游戏 UI 特化规范。
> **触发条件**：开发/修改 UI 组件、布局、样式、游戏界面时阅读。

---

## 0. UI 改动分级流程（强制）

> ### 0.1 修 bug / 微调（无需额外流程）
> 修复布局错位、调整间距/字号/颜色微调、修复交互 bug 等。直接改即可。
>
> ### 0.2 新增 UI 元素（必须配合现有风格，无需读设计系统文档）
> 新增按钮、面板、提示、弹窗等 UI 元素，即使只改一个文件：
> - **必须复用同模块已有组件**（如 `GameButton`、`SpotlightContainer`），禁止手写原生 `<button>` / `<div>` 替代已有封装
> - **必须参考同文件/同模块的现有样式**（配色、圆角、间距、字号），保持视觉一致
> - **禁止引入与当前风格不一致的颜色/样式**（如现有模块用 amber 主色调，不得引入紫色）
>
> ### 0.3 大规模 UI 改动（必须先读设计系统）
> **判定条件**：涉及 ≥3 个组件文件的样式变更、新增整页/整区域布局、全局配色/字体/间距调整、新游戏 Board 搭建。
> **UI 优化任务**（布局稳定性修复、字号/间距层级调整、视觉层级重构等）也须走此流程。
>
> 必须按以下顺序执行：
> 1. **先读 Skill**：执行 `.windsurf/skills/ui-ux-pro-max/SKILL.md` 中的 `--design-system` 流程，获取通用设计建议（配色/字体/风格/反模式）。
> 2. **再读项目自定义设计系统**：
>    - `design-system/game-ui/MASTER.md` — 游戏 UI 交互通用原则
>    - `design-system/styles/<风格>.md` — 对应视觉风格规范
>    - `design-system/games/<gameId>.md` — 游戏专属覆盖配置（若存在）
> 3. **冲突时以项目自定义设计系统为准**：Skill 提供的是通用建议，项目 `design-system/` 是权威来源；两者冲突时，以后者为准。

---

## 1. 核心审美准则 (Visual Excellence)

- **深度感 (Depth)**：通过渐变、阴影、毛玻璃构建视觉层级，但需按场景分级使用：
  - **重点区域**（游戏结算、核心面板）：可使用毛玻璃 + 软阴影增强层级感
  - **一般区域**（确认弹窗、列表项）：使用纯色/简单渐变 + 轻阴影即可
  - **高频更新区域**（动画中元素、拖拽对象）：**禁止毛玻璃**，仅用 `opacity`/`transform`
- **动效反馈 (Motion)**：状态变更应有动效反馈，但需区分场景：
  - **关键交互**（确认/提交/阶段转换）：使用物理动效（弹簧/惯性）
  - **常规交互**（Hover/Focus）：使用简单 `transition`（150-200ms）
  - **高频交互**（快速点击/连续操作）：仅用颜色/透明度变化，禁止复杂动画
- **布局稳定性 (Layout)**：动态内容通过 `absolute` 或预留空间实现。**辅助按钮严禁占据核心业务流空间，必须以悬浮 (Overlay) 方式贴边/贴底显示。**
- **临时/瞬态 UI 不得挤压已有布局（强制）**：攻击修正徽章、buff 提示、倒计时标签等"出现/消失"的临时 UI 元素，必须使用 `absolute`/`fixed` 定位，禁止插入 flex/grid 正常流导致其他元素位移。若需占位，必须在初始布局中预留固定空间（如 `invisible` 占位符）。
- **数据/逻辑/UI 分离（强制）**：UI 只负责展示与交互，业务逻辑放在引擎/系统/领域层，数据定义与配置（manifest、常量表、资源清单、文案 key）用纯数据文件维护。

---

## 2. 多端布局策略 (Multi-Device Layout Strategy)

- **PC 核心驱动 (PC-First)**：以 PC 端 (16:9) 为核心设计基准，追求极致的大屏沉浸感与专业级交互操作。
- **场景自适应 (Scene-Centric)**：针对游戏内核进行自适应优化。移动端定位为"尽力兼容 (Best-effort Compatibility)"，优先保证核心功能可用。
- **宽限度约束 (Constraints)**：平台/网页 UI 通过 `max-w-7xl` 等容器限制内容延展，确保视觉焦点集中。
- **响应式策略指南 (Responsive Strategy Guidelines)**：
    - **信息交互层 (UI & HUD)**：
        - **场景**：大厅卡片、侧边栏、模态框、文字阅读区。
        - **建议**：**稳定性优先**。推荐使用标准 `rem`，建议配合 `clamp()` 锁定物理最小值（12px/14px），保证全环境可读。
    - **沉浸视效层 (Immersive & Board)**：
        - **场景**：游戏棋盘、全屏背景、核心对战区域。
        - **建议**：**比例优先**。推荐使用 `vw/vh`、`%` 或 `aspect-ratio`，确保游戏画面能完整填充用户视口，保持沉浸感。
    - **布局流动层 (Layout Flow)**：
        - **场景**：列表网格、工具栏排列。
        - **建议**：**内容驱动**。利用 Flex/Grid 的自然流特性（如自动填充、自动换行）来适配屏幕宽度，而非依赖硬编码的断点控制。

---

## 3. 游戏 UI 特化范式 (Game-Centric Design)

> **⚠️ 游戏内 UI 必须遵循设计系统规范**
> 
> - **交互原则**：`design-system/game-ui/MASTER.md`（所有游戏通用）
> - **视觉风格**：`design-system/styles/` 下选择合适风格
>   - `arcade-3d.md` - 街机立体风（休闲、派对、骰子类）
>   - `tactical-clean.md` - 战术简洁风（策略、卡牌对战）
>   - `classic-parchment.md` - 经典羊皮纸风（复古、桌游模拟）
> 
> **核心要求**：游戏感 = 即时反馈 + 状态清晰 + 操作愉悦
> - 所有可交互元素必须有 hover/press 反馈
> - 禁用状态必须视觉明显
> - 动画只用 transform/opacity，时长 150-300ms

- **动态提示 UI（强制）**：
    - 必须使用 `absolute`/`fixed`，禁止占用布局空间（如 `relative/static`）。
    - 出现/消失不得挤压或移动其他 UI；新增前必须验证布局稳定性（尤其右侧栏/手牌区/技能区等核心区）。
    - **层级统一**：使用 `UI_Z_INDEX` 常量（如提示用 `UI_Z_INDEX.hint/overlayRaised`，模态用 `UI_Z_INDEX.modalOverlay/modalContent`），禁止硬编码 `z-[...]`。
    - 常用位置：顶部中央（交互选择）、正中央（等待）、手牌上方（弃牌）；默认 `pointer-events-none`（除非需要交互）。
- **动态效果视觉提示实施规范（强制）**：
    > 当全链路审查（见 `engine-systems.md`「描述→实现全链路审查规范」）发现动态赋予效果缺少 UI 提示时，按以下规范实施。
    - **力量修正**：修正后的力量值必须与基础值有视觉区分。正向修正用绿色/上箭头，负向修正用红色/下箭头，显示格式为 `基础值 → 当前值` 或 `当前值(±N)`。
    - **持续保护/限制**：在受影响实体上显示小图标（盾牌=不可消灭、锁=不可移动、禁止=不可打出），hover 显示效果来源。
    - **基地持续效果**：基地卡下方显示当前生效的效果摘要文字（从 i18n 获取），多个效果竖向堆叠。
    - **临时 buff/debuff**：使用 `absolute` 定位的徽章/标签，附带淡入淡出动画（150-200ms），效果结束时自动消失。禁止插入正常流。
    - **条件触发效果**：条件满足时在实体上显示发光边框或脉冲动画，条件不满足时无视觉标记。
    - **附着行动卡**：随从/基地上附着的 ongoing 行动卡必须有视觉标记（如卡牌角标或堆叠指示器），hover/点击可查看附着卡详情。
    - **不确定时必须询问用户**：如果效果的 UI 展示方式不明确（图标样式、放置位置、颜色选择、文字 vs 图标），**必须先询问用户确认再实现**，禁止自行猜测。
- **视角解耦 (Scene vs. HUD)**：
    - **场景层 (Scene)**：棋盘、卡片等核心实体，需通过 `anchorPoint` 处理坐标缩放，确保跨平台逻辑一致性。
    - **UI 层 (HUD)**：状态信息、控制面板，执行 Overlay 挂载逻辑。
- **高度稳定性**：核心游戏区（棋盘/面板）**必须**使用明确高度约束（如 `h-[35vw]`）代替 `h-full`，彻底解耦父级 Flex 依赖。
- **相位敏感性**：UI 必须清晰反馈当前"游戏相位"与"操作权限"，通过高亮合规动作 (Valid Actions) 降低认知负荷。
