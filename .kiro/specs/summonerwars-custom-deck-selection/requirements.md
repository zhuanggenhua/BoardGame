# 召唤师战争 - 自定义牌组选择界面

## 概述

当前召唤师战争的自定义牌组功能已支持保存多份牌组到后端，但在阵营选择界面只显示一个"+"占位符。本需求旨在改进阵营选择界面，让已保存的自定义牌组以卡片形式展示（与默认阵营牌组一致），提升用户体验。

## 用户故事

### US-1: 查看已保存的自定义牌组
**作为** 玩家  
**我希望** 在阵营选择界面看到我已保存的自定义牌组（以卡片形式展示）  
**以便** 快速选择使用我之前构建的牌组

**验收标准：**
- AC-1.1: 阵营选择界面加载时，自动从后端获取当前玩家已保存的自定义牌组列表
- AC-1.2: 已保存的自定义牌组以卡片形式展示，样式与默认阵营卡片一致
- AC-1.3: 自定义牌组卡片显示以下信息：
  - 牌组名称
  - 召唤师所属阵营（通过召唤师卡牌图片展示）
  - "DIY"标识徽章（区分默认牌组）
- AC-1.4: 最多显示 2 个已保存的自定义牌组（按创建时间倒序）
- AC-1.5: 如果没有已保存的牌组，不显示自定义牌组卡片

### US-2: 选择自定义牌组进入对局
**作为** 玩家  
**我希望** 点击自定义牌组卡片可以直接选择使用该牌组  
**以便** 快速开始游戏而无需重新构建牌组

**验收标准：**
- AC-2.1: 点击自定义牌组卡片后，该牌组被标记为"已选择"状态（视觉高亮）
- AC-2.2: 选择自定义牌组后，玩家状态区显示该牌组信息（牌组名称 + 召唤师阵营）
- AC-2.3: 选择自定义牌组后，可以点击"准备"按钮（非房主）或"开始游戏"按钮（房主）
- AC-2.4: 游戏开始时，使用选中的自定义牌组数据初始化游戏状态
- AC-2.5: 选择自定义牌组后，可以切换选择其他阵营或其他自定义牌组

### US-3: 创建新的自定义牌组
**作为** 玩家  
**我希望** 点击"+"按钮可以打开牌组构建器创建新牌组  
**以便** 构建更多不同策略的牌组

**验收标准：**
- AC-3.1: "+"按钮始终显示在自定义牌组卡片之后
- AC-3.2: 点击"+"按钮打开牌组构建器（DeckBuilderDrawer）
- AC-3.3: 牌组构建器处于"新建模式"（不加载任何已有牌组）
- AC-3.4: 保存新牌组后，阵营选择界面自动刷新显示新牌组

### US-4: 编辑已保存的自定义牌组
**作为** 玩家  
**我希望** 可以编辑已保存的自定义牌组  
**以便** 调整牌组策略而无需重新构建

**验收标准：**
- AC-4.1: 自定义牌组卡片上显示"编辑"按钮（hover 时显示）
- AC-4.2: 点击"编辑"按钮打开牌组构建器并加载该牌组数据
- AC-4.3: 修改并保存后，阵营选择界面自动刷新显示更新后的牌组信息

### US-5: 自定义牌组管理
**作为** 玩家  
**我希望** 可以管理我的自定义牌组数量  
**以便** 控制阵营选择界面显示的牌组

**验收标准：**
- AC-5.1: 阵营选择界面保持 4 列网格布局（不变）
- AC-5.2: 卡片顺序：6 个默认阵营 → 最多 2 个自定义牌组 → 1 个"+"按钮（如果未满 2 个）
- AC-5.3: 总共最多 8 个卡片位置（6 个默认 + 2 个自定义槽位）
- AC-5.4: 如果已有 2 个自定义牌组，"+"按钮不显示
- AC-5.5: 可以在牌组构建器中删除牌组来腾出位置
- AC-5.6: 删除牌组后，阵营选择界面自动刷新，"+"按钮重新显示

## 非功能需求

### NFR-1: 性能
- 阵营选择界面加载时，自定义牌组列表获取不应阻塞界面渲染
- 自定义牌组卡片的召唤师图片应使用已有的精灵图系统（CardSprite）

### NFR-2: 可维护性
- 自定义牌组卡片组件（CustomDeckCard）应与默认阵营卡片组件（FactionCard）保持一致的代码结构
- 复用已有的 API 接口（listCustomDecks, getCustomDeck）

### NFR-3: 用户体验
- 自定义牌组卡片的动画效果应与默认阵营卡片一致（framer-motion）
- 加载状态应有适当的视觉反馈（loading spinner 或 skeleton）

## 技术约束

1. **后端 API 已就绪**：`listCustomDecks` 和 `getCustomDeck` 接口已实现
2. **认证依赖**：需要用户登录（token）才能获取自定义牌组列表
3. **精灵图系统**：必须使用 `CardSprite` 组件渲染召唤师卡牌
4. **国际化**：所有文案必须支持中英文（i18n）

## 依赖关系

- 依赖现有的 `useDeckBuilder` Hook（已实现保存/加载/删除功能）
- 依赖现有的 `DeckBuilderDrawer` 组件（牌组构建器）
- 依赖现有的 `FactionSelectionAdapter` 组件（阵营选择界面）

## 排除范围

以下功能不在本次需求范围内：
- 删除自定义牌组（在牌组构建器中已有）
- 自定义牌组的分享功能
- 自定义牌组的导入/导出功能
- 显示超过 2 个自定义牌组（未来可扩展）

## 验收测试场景

### 场景 1: 首次使用（无已保存牌组）
1. 用户登录后进入召唤师战争
2. 创建房间并进入阵营选择界面
3. 界面显示 6 个默认阵营卡片 + 1 个"+"按钮
4. 点击"+"按钮打开牌组构建器
5. 构建并保存第一个自定义牌组
6. 返回阵营选择界面，看到新牌组卡片

### 场景 2: 选择已保存的自定义牌组
1. 用户已有 2 个已保存的自定义牌组
2. 进入阵营选择界面
3. 界面显示 6 个默认阵营 + 2 个自定义牌组 + 1 个"+"按钮
4. 点击第一个自定义牌组卡片
5. 该卡片高亮显示，玩家状态区显示牌组信息
6. 点击"准备"按钮
7. 房主点击"开始游戏"
8. 游戏使用选中的自定义牌组初始化

### 场景 3: 编辑已保存的自定义牌组
1. 用户已有 1 个已保存的自定义牌组
2. 进入阵营选择界面
3. Hover 自定义牌组卡片，显示"编辑"按钮
4. 点击"编辑"按钮
5. 牌组构建器打开并加载该牌组数据
6. 修改牌组（添加/移除卡牌）
7. 保存修改
8. 返回阵营选择界面，看到更新后的牌组信息

## 国际化文案需求

需要添加以下 i18n keys（`public/locales/{lang}/game-summonerwars.json`）：

```json
{
  "factionSelection": {
    "customDeck": "自定义牌组",
    "customDeckLabel": "自定义牌组",
    "customDeckSummoner": "{{name}} 召唤师",
    "clickToBuild": "点击构建",
    "editDeck": "编辑牌组",
    "newDeck": "新建牌组"
  }
}
```

英文版本：
```json
{
  "factionSelection": {
    "customDeck": "Custom Deck",
    "customDeckLabel": "Custom Deck",
    "customDeckSummoner": "{{name}} Summoner",
    "clickToBuild": "Click to Build",
    "editDeck": "Edit Deck",
    "newDeck": "New Deck"
  }
}
```
